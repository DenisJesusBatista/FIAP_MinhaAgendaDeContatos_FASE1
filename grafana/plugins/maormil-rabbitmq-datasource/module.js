define(["@grafana/data","@grafana/runtime","react","@grafana/ui"],((e,t,n,a)=>(()=>{"use strict";var l={305:t=>{t.exports=e},545:e=>{e.exports=t},388:e=>{e.exports=a},650:e=>{e.exports=n}},r={};function o(e){var t=r[e];if(void 0!==t)return t.exports;var n=r[e]={exports:{}};return l[e](n,n.exports,o),n.exports}o.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return o.d(t,{a:t}),t},o.d=(e,t)=>{for(var n in t)o.o(t,n)&&!o.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},o.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),o.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var i={};return(()=>{o.r(i),o.d(i,{plugin:()=>f});var e=o(305),t=o(545);class n extends t.DataSourceWithBackend{constructor(e){super(e)}}var a=o(650),l=o.n(a),r=o(388);const s=30,c=30,u=10;function d(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function h({exchanges:e,setExchanges:t}){const n="rabbitmq.exchange",a=[{label:"Fanout",value:"fanout"},{label:"Direct",value:"direct"},{label:"Topic",value:"topic"},{label:"Headers",value:"headers"},{label:"X Consistent Hash",value:"x-consistent-hash"}],o=(e,n,a)=>{t((t=>t.map(((t,l)=>{return l===e?(r=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},a=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),a.forEach((function(t){d(e,t,n[t])}))}return e}({},t),o=null!=(o={[n]:a})?o:{},Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(o)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n.push.apply(n,a)}return n}(Object(o)).forEach((function(e){Object.defineProperty(r,e,Object.getOwnPropertyDescriptor(o,e))})),r):t;var r,o}))))};return l().createElement(l().Fragment,null,e.map(((e,i)=>l().createElement(l().Fragment,null,l().createElement(r.InlineField,{label:"Should Dispose Exchange",labelWidth:s,tooltip:"Should delete this exchange when the RabbitMQ datasource is deleted"},l().createElement(r.InlineSwitch,{onChange:e=>o(i,"shouldDisposeExchange",e.currentTarget.checked),value:e.shouldDisposeExchange,width:u})),l().createElement(r.InlineField,{label:"Dispose if Unused",labelWidth:s,tooltip:"Delete this exchange only if it doesn't have bindings (and if 'Should Dispose Exchange' is set ON)"},l().createElement(r.InlineSwitch,{onChange:e=>o(i,"disposeIfUnused",e.currentTarget.checked),value:e.disposeIfUnused,width:u})),l().createElement(r.InlineField,{label:"Exchange Name",labelWidth:s,tooltip:"The exchange name that should exist in the RabbitMQ"},l().createElement(r.Input,{onChange:e=>o(i,"name",e.currentTarget.value||n),value:e.name,width:c})),l().createElement(r.InlineField,{label:"Exchange Type",labelWidth:s,tooltip:"The exchange type"},l().createElement(r.RadioButtonGroup,{options:a,value:e.type,onChange:e=>o(i,"type",e)})),l().createElement(r.InlineField,{label:"Is Durable",labelWidth:s,tooltip:"Should the exchange be durable"},l().createElement(r.InlineSwitch,{onChange:e=>o(i,"durable",e.currentTarget.checked),value:e.durable,width:u})),l().createElement(r.InlineField,{label:"Is Auto Deleted",labelWidth:s,tooltip:"Should the exchange be auto deleted"},l().createElement(r.InlineSwitch,{onChange:e=>o(i,"autoDeleted",e.currentTarget.checked),value:e.autoDeleted,width:u})),l().createElement(r.InlineField,{label:"Is Internal",labelWidth:s,tooltip:"Should the exchange be internal"},l().createElement(r.InlineSwitch,{onChange:e=>o(i,"internal",e.currentTarget.checked),value:e.internal,width:u})),l().createElement(r.InlineField,{label:"Is No Wait",labelWidth:s,tooltip:"Should the exchange be noWait"},l().createElement(r.InlineSwitch,{onChange:e=>o(i,"noWait",e.currentTarget.checked),value:e.noWait,width:u})),l().createElement(r.Button,{variant:"secondary",fill:"text",icon:"minus",onClick:()=>(e=>{t((t=>t.filter(((t,n)=>n!==e))))})(i),tooltip:"Remove","aria-label":"Remove"})))),l().createElement(r.Button,{variant:"secondary",fill:"text",icon:"plus",onClick:()=>{const e={shouldDisposeExchange:!0,disposeIfUnused:!0,name:n,type:"fanout",durable:!0,autoDeleted:!1,internal:!1,noWait:!1};t((t=>[...t,e]))},tooltip:"Add","aria-label":"Add"}))}function m(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function b({bindings:e,setBindings:t}){const n="rabbitmq.exchange",a="rabbitmq.stream",o=(e,n,a)=>{t((t=>t.map(((t,l)=>{return l===e?(r=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},a=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),a.forEach((function(t){m(e,t,n[t])}))}return e}({},t),o=null!=(o={[n]:a})?o:{},Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(o)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n.push.apply(n,a)}return n}(Object(o)).forEach((function(e){Object.defineProperty(r,e,Object.getOwnPropertyDescriptor(o,e))})),r):t;var r,o}))))};return l().createElement(l().Fragment,null,e.map(((e,i)=>l().createElement(l().Fragment,null,l().createElement(r.InlineField,{label:"Should Dispose Binding",labelWidth:s,tooltip:"Should unbind when the RabbitMQ datasource is deleted"},l().createElement(r.InlineSwitch,{onChange:e=>o(i,"shouldDisposeBinding",e.currentTarget.checked),value:e.shouldDisposeBinding,width:u})),l().createElement(r.InlineField,{label:"Is Queue Binding",labelWidth:s,tooltip:"Should binding be from Exchange to queue/stream (if disabled, the binding will be from exchange to exchange"},l().createElement(r.InlineSwitch,{onChange:e=>o(i,"isQueueBinding",e.currentTarget.checked),value:e.isQueueBinding,width:u})),l().createElement(r.InlineField,{label:"Sender Name",labelWidth:s,tooltip:"The exchange to bind from"},l().createElement(r.Input,{onChange:e=>o(i,"senderName",e.currentTarget.value||n),value:e.senderName,width:c})),l().createElement(r.InlineField,{label:"Routing Key",labelWidth:s,tooltip:"The routing key to bind between the sender exchange and the receiver"},l().createElement(r.Input,{onChange:e=>o(i,"routingKey",e.currentTarget.value||"/"),value:e.routingKey,width:c})),l().createElement(r.InlineField,{label:"Receiver Name",labelWidth:s,tooltip:"The stream/queue/exchange to bind to"},l().createElement(r.Input,{onChange:e=>o(i,"receiverName",e.currentTarget.value||a),value:e.receiverName,width:c})),l().createElement(r.InlineField,{label:"Is No Wait",labelWidth:s,tooltip:"Should binding be noWait"},l().createElement(r.InlineSwitch,{onChange:e=>o(i,"noWait",e.currentTarget.checked),value:e.noWait,width:u})),l().createElement(r.Button,{variant:"secondary",fill:"text",icon:"minus",onClick:()=>(e=>{t((t=>t.filter(((t,n)=>n!==e))))})(i),tooltip:"Remove","aria-label":"Remove"})))),l().createElement(r.Button,{variant:"secondary",fill:"text",icon:"plus",onClick:()=>{const e={shouldDisposeBinding:!1,isQueueBinding:!0,senderName:n,routingKey:"/",receiverName:a,noWait:!1};t((t=>[...t,e]))},tooltip:"Add","aria-label":"Add"}))}function g(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function p(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},a=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),a.forEach((function(t){g(e,t,n[t])}))}return e}function v(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n.push.apply(n,a)}return n}(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})),e}const f=new e.DataSourcePlugin(n).setConfigEditor((e=>{var t,n,o,i,d,m,g,f,E,S,y,w,O,I,j;const{onOptionsChange:D,options:x,options:{jsonData:F,secureJsonData:C,secureJsonFields:P}}=e,T="localhost",W="guest",B="guest",R=1048576,k="rabbitmq.stream",N=36e11,M=2e9,Q=5e8,q=(e,t,n)=>({host:T,amqpPort:5672,streamPort:5552,vHost:"/",tlsConnection:!1,username:W,streamOptions:e,exchangesOptions:t,bindingsOptions:n,requestedHeartbeat:60,requestedMaxFrameSize:R,writeBuffer:8192,readBuffer:65536,noDelay:!1});var A,H,J,z,L,U,K,_;const[G,V]=(0,a.useState)({shouldDisposeStream:null===(A=null==F||null===(t=F.streamOptions)||void 0===t?void 0:t.shouldDisposeStream)||void 0===A||A,streamName:null!==(H=null==F||null===(n=F.streamOptions)||void 0===n?void 0:n.streamName)&&void 0!==H?H:k,consumerName:null!==(J=null==F||null===(o=F.streamOptions)||void 0===o?void 0:o.consumerName)&&void 0!==J?J:"",maxAge:null!==(z=null==F||null===(i=F.streamOptions)||void 0===i?void 0:i.maxAge)&&void 0!==z?z:N,maxLengthBytes:null!==(L=null==F||null===(d=F.streamOptions)||void 0===d?void 0:d.maxLengthBytes)&&void 0!==L?L:M,maxSegmentSizeBytes:null!==(U=null==F||null===(m=F.streamOptions)||void 0===m?void 0:m.maxSegmentSizeBytes)&&void 0!==U?U:Q,offsetFromStart:null===(K=null==F||null===(g=F.streamOptions)||void 0===g?void 0:g.offsetFromStart)||void 0===K||K,crc:null!==(_=null==F||null===(f=F.streamOptions)||void 0===f?void 0:f.crc)&&void 0!==_&&_});var X;const[Y,Z]=(0,a.useState)(null!==(X=null==F?void 0:F.exchangesOptions)&&void 0!==X?X:[]);var $;const[ee,te]=(0,a.useState)(null!==($=null==F?void 0:F.bindingsOptions)&&void 0!==$?$:[]),ne=(e,t,n)=>{const a=parseInt(e,10);n(isNaN(a)?t:a)};var ae,le,re,oe,ie,se,ce,ue,de,he,me;return(0,a.useEffect)((()=>{D(v(p({},x),{jsonData:v(p({},x.jsonData),{streamOptions:G})}))}),[G]),(0,a.useEffect)((()=>{D(v(p({},x),{jsonData:v(p({},x.jsonData),{exchangesOptions:Y})}))}),[Y]),(0,a.useEffect)((()=>{D(v(p({},x),{jsonData:v(p({},x.jsonData),{bindingsOptions:ee})}))}),[ee]),(0,a.useEffect)((()=>{var e;e=F,0===Object.keys(e).length&&D(v(p({},x),{jsonData:p({},q(G,Y,ee)),secureJsonFields:v(p({},x.secureJsonFields),{password:!0}),secureJsonData:v(p({},x.secureJsonData),{password:B})}))}),[]),l().createElement("div",{className:"gf-form-group"},l().createElement(r.FieldSet,{label:"Connection"},l().createElement(r.InlineField,{label:"Host",labelWidth:s,tooltip:"Hostname (or the IP) of the RabbitMQ server"},l().createElement(r.Input,{onChange:e=>D(v(p({},x),{jsonData:v(p({},x.jsonData),{host:e.currentTarget.value||T})})),value:null!==(ae=null==F?void 0:F.host)&&void 0!==ae?ae:"",width:c})),l().createElement(r.InlineField,{label:"AMQP Port",labelWidth:s,tooltip:"The AMQP port of the RabbitMQ server"},l().createElement(r.Input,{onChange:e=>ne(e.currentTarget.value,5672,(e=>D(v(p({},x),{jsonData:v(p({},x.jsonData),{amqpPort:e})})))),value:null!==(le=null==F||null===(E=F.amqpPort)||void 0===E?void 0:E.toString())&&void 0!==le?le:"",width:c})),l().createElement(r.InlineField,{label:"Stream Port",labelWidth:s,tooltip:"The stream port of the RabbitMQ server"},l().createElement(r.Input,{onChange:e=>ne(e.currentTarget.value,5552,(e=>D(v(p({},x),{jsonData:v(p({},x.jsonData),{streamPort:e})})))),value:null!==(re=null==F||null===(S=F.streamPort)||void 0===S?void 0:S.toString())&&void 0!==re?re:"",width:c})),l().createElement(r.InlineField,{label:"VHost",labelWidth:s,tooltip:"The virtual host the RabbitMQ server"},l().createElement(r.Input,{onChange:e=>D(v(p({},x),{jsonData:v(p({},x.jsonData),{vHost:e.currentTarget.value||"/"})})),value:null!==(oe=null==F||null===(y=F.vHost)||void 0===y?void 0:y.toString())&&void 0!==oe?oe:"",width:c}))),l().createElement(r.FieldSet,{label:"Authentication"},l().createElement(r.InlineField,{label:"TLS Connection",labelWidth:s,tooltip:"Should use TLS to connect to the RabbitMQ server"},l().createElement(r.InlineSwitch,{onChange:e=>D(v(p({},x),{jsonData:v(p({},x.jsonData),{tlsConnection:e.currentTarget.checked})})),value:null!==(ie=null==F?void 0:F.tlsConnection)&&void 0!==ie&&ie,width:u})),l().createElement(r.InlineField,{label:"Username",labelWidth:s,tooltip:"Username to connect to the RabbitMQ server"},l().createElement(r.Input,{onChange:e=>D(v(p({},x),{jsonData:v(p({},x.jsonData),{username:e.currentTarget.value||W})})),value:null!==(se=null==F?void 0:F.username)&&void 0!==se?se:"",width:c})),l().createElement(r.InlineField,{label:"Password",labelWidth:s,tooltip:"Password to connect to the RabbitMQ server"},l().createElement(r.SecretInput,{isConfigured:!!P.password,value:null!==(ce=null==C?void 0:C.password)&&void 0!==ce?ce:B,width:c,onReset:()=>{D(v(p({},x),{secureJsonFields:v(p({},x.secureJsonFields),{password:!1}),secureJsonData:v(p({},x.secureJsonData),{password:""})}))},onChange:e=>{D(v(p({},x),{secureJsonData:{password:e.target.value}}))}}))),l().createElement(r.FieldSet,{label:"Stream Settings"},l().createElement(r.InlineField,{label:"Should Dispose Stream",labelWidth:s,tooltip:"Should delete this stream (in the RabbitMQ) when the RabbitMQ datasource is deleted"},l().createElement(r.InlineSwitch,{onChange:e=>V(v(p({},G),{shouldDisposeStream:e.currentTarget.checked})),value:G.shouldDisposeStream,width:u})),l().createElement(r.InlineField,{label:"Stream Name",labelWidth:s,tooltip:"The stream name that will be created"},l().createElement(r.Input,{onChange:e=>V(v(p({},G),{streamName:e.currentTarget.value||k})),value:G.streamName,width:c})),l().createElement(r.InlineField,{label:"Consumer Name",labelWidth:s,tooltip:"The consumer name that will be created"},l().createElement(r.Input,{onChange:e=>V(v(p({},G),{consumerName:e.currentTarget.value})),value:G.consumerName,placeholder:"Consumer Name (can be empty)",width:c})),l().createElement(r.InlineField,{label:"Offset From Start",labelWidth:s,tooltip:"Should the consumer consume messages from the start or the end of the stored messages in the stream"},l().createElement(r.InlineSwitch,{onChange:e=>V(v(p({},G),{offsetFromStart:e.currentTarget.checked})),value:G.offsetFromStart,width:u})),l().createElement(r.InlineField,{label:"Max Age",labelWidth:s,tooltip:"The max age of messages in the stream in nano-seconds (set to 0 to disable the max-age limit)"},l().createElement(r.Input,{onChange:e=>ne(e.currentTarget.value,N,(e=>V(v(p({},G),{maxAge:e})))),value:G.maxAge.toString(),width:c})),l().createElement(r.InlineField,{label:"Max Length Bytes",labelWidth:s,tooltip:"The max length of messages in bytes in the stream (set to 0 to disable the max-length-bytes limit)"},l().createElement(r.Input,{onChange:e=>ne(e.currentTarget.value,M,(e=>V(v(p({},G),{maxLengthBytes:e})))),value:G.maxLengthBytes.toString(),width:c})),l().createElement(r.InlineField,{label:"Max Segment Size Bytes",labelWidth:s,tooltip:"The max segment size in bytes in the stream"},l().createElement(r.Input,{onChange:e=>ne(e.currentTarget.value,Q,(e=>V(v(p({},G),{maxSegmentSizeBytes:e})))),value:G.maxSegmentSizeBytes.toString(),width:c})),l().createElement(r.InlineField,{label:"CRC",labelWidth:s,tooltip:"When CRC control is disabled, the perfomance is increased"},l().createElement(r.InlineSwitch,{onChange:e=>V(v(p({},G),{crc:e.currentTarget.checked})),value:G.crc,width:u}))),l().createElement(r.FieldSet,{label:"Exchanges"},l().createElement(h,{exchanges:Y,setExchanges:Z})),l().createElement(r.FieldSet,{label:"Bindings"},l().createElement(b,{bindings:ee,setBindings:te})),l().createElement(r.FieldSet,{label:"Advanced RabbitMQ Stream Settings"},l().createElement(r.InlineField,{label:"Requested Heartbeat",labelWidth:s},l().createElement(r.Input,{onChange:e=>ne(e.currentTarget.value,60,(e=>D(v(p({},x),{jsonData:v(p({},x.jsonData),{requestedHeartbeat:e})})))),value:null!==(ue=null==F||null===(w=F.requestedHeartbeat)||void 0===w?void 0:w.toString())&&void 0!==ue?ue:"",width:c})),l().createElement(r.InlineField,{label:"Requested Max FrameSize",labelWidth:s},l().createElement(r.Input,{onChange:e=>ne(e.currentTarget.value,R,(e=>D(v(p({},x),{jsonData:v(p({},x.jsonData),{requestedMaxFrameSize:e})})))),value:null!==(de=null==F||null===(O=F.requestedMaxFrameSize)||void 0===O?void 0:O.toString())&&void 0!==de?de:"",width:c})),l().createElement(r.InlineField,{label:"Write Buffer",labelWidth:s},l().createElement(r.Input,{onChange:e=>ne(e.currentTarget.value,8192,(e=>D(v(p({},x),{jsonData:v(p({},x.jsonData),{writeBuffer:e})})))),value:null!==(he=null==F||null===(I=F.writeBuffer)||void 0===I?void 0:I.toString())&&void 0!==he?he:"",width:c})),l().createElement(r.InlineField,{label:"Read Buffer",labelWidth:s},l().createElement(r.Input,{onChange:e=>ne(e.currentTarget.value,65536,(e=>D(v(p({},x),{jsonData:v(p({},x.jsonData),{readBuffer:e})})))),value:null!==(me=null==F||null===(j=F.readBuffer)||void 0===j?void 0:j.toString())&&void 0!==me?me:"",width:c})),l().createElement(r.InlineField,{label:"No Delay",labelWidth:s},l().createElement(r.InlineSwitch,{onChange:e=>D(v(p({},x),{jsonData:v(p({},x.jsonData),{noDelay:e.currentTarget.checked})})),value:F.noDelay,width:u}))))})).setQueryEditor((()=>l().createElement(l().Fragment,null,l().createElement(r.InlineLabel,{width:20,tooltip:"The Consumer of the RabbitMQ Stream is Created Once You Press Refresh Dashboard!"},"Ready to go!"))))})(),i})()));
//# sourceMappingURL=module.js.map